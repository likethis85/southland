<{include file=skin/$skin/header.html}>
<script type="text/javascript">
    $(document).ready(function(){
        jQuery.extend(jQuery.validator.messages, {
            required:"<span style=\"color:red\">*</span>"
        });
        UE.getEditor('IssueDesc',{
            //focus时自动清空初始化时的内容
            autoClearinitialContent:false,
            //关闭字数统计
            wordCount:true,
            //关闭elementPath
            elementPathEnabled:false
            //更多其他参数，请参考editor_config.js中的配置项
        });
        $("#form").validate({
            rules:{
                subject:{required:true}
            }
        });
        
        $('div.file .clear').hover(
            function(){$(this).css({'background-color':'green'});},
            function(){$(this).css({'background-color':'transparent'});}
        );
        $('input.file').hover(
            function() { $(this).prev().css({'background-color':'orange'})},
            function() { $(this).prev().css({'background-color':'transparent'})}
        ).live('change', function(){
            $(this.parentNode.parentNode.parentNode).append('<td>'+this.value+'</td>');
            $('div.file table').append($('<tr><td><div style="position:relative;width:80px;height:24px;"><input type="button" class="browse" value=\"<{T w="Attachment"}>\" /><input type="file" class="file" name="attachments[]" /></div></td><td><input type="button" class="clear" value=\"<{T w="Clear"}>\" /></td></tr>'));
            $('input.file').hover(
                function() { $(this).prev().css({'background-color':'orange'})},
                function() { $(this).prev().css({'background-color':'transparent'})}
            );
            $('div.file .clear').hover(
                function(){$(this).css({'background-color':'green'});},
                function(){$(this).css({'background-color':'transparent'});}
            ).click(function() {
                if($('div.file table tr').length == 1)
                    return;
                    
                $(this.parentNode.parentNode).remove();
            });
        });
    });
</script>
<div style="clear:both;margin-left:32px;margin-top:32px;width:600px;">
    <form id="form" method="post" enctype="multipart/form-data">
        <table>
            <tr>
                <td><label style="margin-right:8px" for="IssueBrief"><{T w='IssueTitle'}></label></td>
                <td><input name="IssueBrief" type="text" value="" style="width:490px"/></td>
            </tr>                
            <tr>
                <td><label style="margin-right:8px"><{T w='IssueRef'}></label></td>
                <td>
                    <select style="width:490px;" name="tid">
                        <option value="0" <{if $tTid eq 0}>selected<{/if}>>N/A</option>
                        <{foreach item=item from=$tTasks}>
                        <option value="$item.id" <{if $tTid eq $item.id}>selected<{/if}> ><{$item.subject}></option>
                        <{/foreach}>
                    </select>
                </td>
            </tr>
            <tr>
                <td><label style="margin-right:8px"><{T w='IssueOwner'}></label></td>
                <td>
                    <select style="width:490px;" name="oid">
                        <{foreach item=item from=$tMembers}>
                        <option value="<{$item.id}>" selected><{$item.nick}></option>
                        <{/foreach}>
                    </select>
                </td>
            </tr>
            <tr>
                <td style="width:88px;"><label style="margin-right:8px" for="IssuePri"><{T w='IssuePriority'}></label></td>
                <td>
                    <input type="radio" name="IssuePri" value="1"><img src="<{$skinpath}>/img/1.gif" />
                    <input type="radio" name="IssuePri" value="2" checked><img src="<{$skinpath}>/img/2.gif" />
                    <input type="radio" name="IssuePri" value="3"><img src="<{$skinpath}>/img/3.gif" />
                </td>
            </tr>
            <tr>
                <td><label style="margin-right:12px;" for="subject"><{T w='ACL'}></label></td>
                <td>
                    <select name='acl' id='acl'>
                        <option value=0 <{if $tProject.acl==0}>selected<{/if}> ><{T w='Public'}></option>
                        <option value=1 <{if $tProject.acl==1}>selected<{/if}> ><{T w='Protected'}></option>
                        <option value=2 <{if $tProject.acl==2}>selected<{/if}> ><{T w='Private'}></option>
                    </select>
                </td>
            </tr>
            <tr>
                <td style="width:88px;"><label style="margin-right:8px" for="TaskPri"><{T w='Attachment'}></label></td>
                <td>
                    <div class="file">
                        <table>
                            <tr>
                                <td><div style="position:relative;width:80px;height:24px;">
                                    <input type='button' class='browse' value='<{T w="Attachment"}>' />
                                    <input type="file" class="file" name="attachments[]" />
                                </div></td>
                                <td><input type="button" class="clear" value='<{T w="Clear"}>'/></td>
                            </tr>
                        </table>
                    </div>
                </td>
            </tr>
            <tr><td colspan="2"><label style="margin-right:8px" for="IssueDesc"><{T w='IssueDesc'}></label></td></tr>
            <tr>
                <td colspan="2">
                    <textarea id="IssueDesc" name="IssueDesc"></textarea>
                    <input class="btn-rounded" type="submit" value=<{T w="CreateNewIssue"}> />
                    <input name="submit" type="hidden" value="1" />
                </td>
            </tr>
        </table>
    </form>
</div>
<{include file=skin/$skin/footer.html}>
